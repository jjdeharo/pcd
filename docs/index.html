<!DOCTYPE html>
<html lang="ca">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Plantilla correctora digital ¬∑ Instruccions</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
      :root {
        --bg: #f5f8fc;
        --text: #1a2733;
        --muted: #607d8b;
        --border: #c5ccda;
        --code-bg: #eef2f7;
        --link: #376082;
        --btn-bg: #eceff4;
        --btn-text: #1a2733;
        --primary: #1976d2;
        --primary-text: #ffffff;
      }
      @media (prefers-color-scheme: dark) {
        :root {
          --bg: #0f1720;
          --text: #e6edf3;
          --muted: #8aa0ae;
          --border: #334155;
          --code-bg: #111827;
          --link: #7db7ff;
          --btn-bg: #1f2a37;
          --btn-text: #e6edf3;
          --primary: #539bf5;
          --primary-text: #0b1220;
        }
      }
      [data-theme="light"] {
        --bg: #f5f8fc;
        --text: #1a2733;
        --muted: #607d8b;
        --border: #c5ccda;
        --code-bg: #eef2f7;
        --link: #376082;
        --btn-bg: #eceff4;
        --btn-text: #1a2733;
        --primary: #1976d2;
        --primary-text: #ffffff;
      }
      [data-theme="dark"] {
        --bg: #0f1720;
        --text: #e6edf3;
        --muted: #8aa0ae;
        --border: #334155;
        --code-bg: #111827;
        --link: #7db7ff;
        --btn-bg: #1f2a37;
        --btn-text: #e6edf3;
        --primary: #539bf5;
        --primary-text: #0b1220;
      }
      html {
        scroll-behavior: smooth;
      }
      body { font-family: Arial, sans-serif; line-height: 1.55; color: var(--text); background: var(--bg); margin: 0; }
      .wrap { max-width: 880px; margin: 0 auto; padding: 2rem 1.25rem 3rem; }
      h1 { margin: 0.2rem 0 0.75rem; font-size: 1.9rem; }
      h2 { margin: 0; font-size: 1.5rem; border-bottom: none; padding-bottom: 0; }
      h3 { margin-top: 1.6rem; font-size: 1.2rem; }
      p, li { font-size: 1rem; }
      code { background: var(--code-bg); padding: 0.1rem 0.3rem; border-radius: 4px; font-family: monospace; }
      .lang { display: none; }
      .lang.active { display: block; }
      .toolbar { display: flex; gap: 0.75rem; align-items: center; justify-content: space-between; margin-bottom: 1rem; }
      .switch { display: flex; gap: 6px; align-items: center; }
      .theme { display: flex; gap: 6px; align-items: center; }
      .btn { background: var(--btn-bg); color: var(--btn-text); border: 1px solid var(--border); padding: 0.3rem 0.7rem; border-radius: 999px; font-size: 0.9rem; cursor: pointer; }
      .btn.active { background: var(--primary); color: var(--primary-text); border-color: var(--primary); }
      .app-footer { text-align: center; color: var(--muted); font-size: 0.95rem; margin: 2rem 0 1.5rem; }
      .app-footer a { color: var(--link); text-decoration: none; }
      .app-footer a:hover { text-decoration: underline; }
      .app-footer .lic-line { margin-top: 0.35rem; }
      .app-footer .docs-line { margin-top: 0.35rem; }
      .app-footer .app-name { font-weight: 600; }
      .app-footer img.cc { vertical-align: middle; height: 20px; margin-left: 6px; opacity: 0.9; }
      
      /* Estilos del acorde√≥n */
      details.accordion {
        border: 1px solid var(--border);
        border-radius: 8px;
        margin-top: 1.5rem;
        background-color: var(--code-bg);
        transition: background-color 0.2s ease;
      }
      details.accordion[open] {
        background-color: var(--bg);
      }
      details.accordion summary {
        list-style: none;
        cursor: pointer;
        padding: 1rem 1.5rem;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      details.accordion summary::-webkit-details-marker {
        display: none;
      }
      details.accordion summary::after {
        content: '‚ñº';
        transform: rotate(-90deg);
        transition: transform 0.2s ease-in-out;
        font-size: 1.2rem;
      }
      details.accordion[open] summary::after {
        transform: rotate(0deg);
      }
      details.accordion .accordion-content {
        padding: 0 1.5rem 1.5rem 1.5rem;
        border-top: 1px solid var(--border);
        margin-top: 0.5rem;
        padding-top: 1.5rem;
      }
      
      /* Animaci√≥n para el acorde√≥n */
      details.accordion[open] > .accordion-content {
        animation: fadeIn 0.5s ease-in-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-1rem);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="toolbar">
        <div class="switch" aria-label="Language selector">
          <button class="btn" data-lang="ca">CA</button>
          <button class="btn" data-lang="es">ES</button>
        </div>
        <div class="theme" title="Tema/Theme">
          <button class="btn theme-btn" data-theme="auto">AUTO</button>
          <button class="btn theme-btn" data-theme="light">‚òÄÔ∏è</button>
          <button class="btn theme-btn" data-theme="dark">üåô</button>
        </div>
      </div>

      <header>
        <h1>Plantilla correctora digital (Google Sheets + Web)</h1>
      </header>
      
      <section class="lang active" id="lang-ca">
        <details class="accordion" open>
            <summary><h2>Qu√® √©s?</h2></summary>
            <div class="accordion-content">
                <p>Aquesta plantilla permet recollir les respostes de <strong>proves de tipus test d'elecci√≥ m√∫ltiple (amb diverses opcions i una √∫nica resposta correcta)</strong> des d'una p√†gina web i desar-les autom√†ticament al teu Full de C√†lcul de Google.</p>
                <ul>
                    <li>Enlla√ß per a l'alumnat (web app).</li>
                    <li>Panell del professorat per configurar, carregar la clau i corregir.</li>
                    <li>Informes detallats amb les notes de l'alumnat i an√†lisis estad√≠stiques de les preguntes.</li>
                </ul>
                <p><strong>Important:</strong> aquesta aplicaci√≥ √©s una <strong>plantilla correctora</strong>. L'examen es lliura en paper i l'alumnat nom√©s introdueix les seves respostes a la web.</p>
            </div>
        </details>
        
        <details class="accordion">
            <summary><h2>Posada en marxa de l'aplicaci√≥ web</h2></summary>
            <div class="accordion-content">
                <p>El proc√©s de posada en marxa consta de dos passos: <strong>crear la teva c√≤pia</strong> del full de c√†lcul i <strong>publicar</strong> l'aplicaci√≥ web per gestionar els ex√†mens. No haur√†s de tocar el full: el sistema ho far√† per tu.</p>
                <ol>
                    <li>Fes clic en <a href="https://docs.google.com/spreadsheets/d/129xDHV5AcSL8GMu2kmGS2f4Gvs6m0BHn1tkQT-JNfEA/copy" target="_blank" rel="noopener noreferrer">aquest enlla√ß</a> i prem el bot√≥ <strong>Fes una c√≤pia</strong>.</li>
                    <li><strong>Publicaci√≥</strong> de l'aplicaci√≥ web:
                        <ol>
                            <li>Al teu nou full de c√†lcul, ves a <em>Extensions ‚Üí Apps Script</em>.</li>
                            <li>A la nova finestra que ha sortit, prem <strong>Implementar ‚Üí Nova implementaci√≥</strong>.</li>
                            <li>Prem <strong>Implementar</strong>.</li>
                            <li>Accepta els permisos:
                                <ul>
                                    <li>Selecciona el teu compte de Google.</li>
                                    <li>Apareixer√† un av√≠s indicant que ‚ÄúAquesta aplicaci√≥ no est√† verificada‚Äù. Fes clic a <strong>Avan√ßat</strong> i despr√©s a <strong>Anar a <em>nom del projecte</em> (no segur)</strong>.</li>
                                    <li>Prem <strong>Permet</strong> a totes les sol¬∑licituds d'acc√©s.</li>
                                </ul>
                            </li>
                            <li>En finalitzar, apareixer√† la <strong>URL</strong> de l'aplicaci√≥ web. Copia-la i desa-la: <strong>ser√† l'adre√ßa que far√†s servir a partir d'ara per accedir al panell del professorat.</strong></li>
                        </ol>
                    </li>
                    <li><strong>MOLT IMPORTANT:</strong> Accedeix al panell amb el codi inicial <code>0000</code> i canvia'l a la pestanya <em>Ajustos</em>.</li>
                </ol>
                <p>Disposes d'una presentaci√≥ amb imatges de tots els passos. Consulta-la a <a href="https://docs.google.com/presentation/d/e/2PACX-1vRRIav1DWcFyrCVMnE5O60_LUgPbxuAopVCw96caWni9VPDEqRhaasc_Nj5GpiBf9BG3nCM8pml37E1/pub?start=false&loop=false&delayms=3000" target="_blank" rel="noopener noreferrer">aquest enlla√ß</a>.</p>
            </div>
        </details>
        
        <details class="accordion">
            <summary><h2>Crear i configurar un examen</h2></summary>
            <div class="accordion-content">
                <p>Un cop dins del panell d'administraci√≥, el proc√©s per crear un examen es fa a trav√©s de les diferents pestanyes.</p>
                <h3>1. Pestanya Resum: crear l'examen</h3>
                <p>A la primera pestanya, <strong>Resum</strong>, prem el bot√≥ <strong>Crea un examen nou</strong>. L'aplicaci√≥ generar√† un identificador √∫nic per a l'examen; a continuaci√≥, haur√†s d'anar a la pestanya <strong>Configuraci√≥</strong> per definir-ne els par√†metres. Si ja tens ex√†mens creats, pots seleccionar-los des del men√∫ desplegable.</p>
                <h3>2. Pestanya Configuraci√≥: definir els par√†metres</h3>
                <p>Aqu√≠ s'estableixen les caracter√≠stiques principals de la prova:</p>
                <ul>
                    <li><strong>Nom de l'examen</strong>: un t√≠tol per identificar-lo (ex. "Examen Biologia Tema 5").</li>
                    <li><strong>Nombre de preguntes</strong>: el total de preguntes que t√© la prova.</li>
                    <li><strong>Opcions disponibles</strong>: les lletres de les respostes (ex. ABCD, ABCDE).</li>
                    <li><strong>Inici i fi programat</strong>: pots definir una data i hora perqu√® l'examen s'obri i es tanqui autom√†ticament. Si ho deixes en blanc, haur√†s d'obrir-lo i tancar-lo manualment. Encara que estableixis una data, sempre pots for√ßar l'obertura o el tancament des dels controls manuals.</li>
                    <li><strong>Mesures de seguretat</strong>: pots activar opcions com barrejar preguntes i/o respostes, o for√ßar la pantalla completa (encara que l'alumne pot sortir d'aquest mode, la finestra es tornar√† a maximitzar amb cada clic que faci a la prova).</li>
                </ul>
                <p>Quan ho hagis omplert tot, prem <strong>Desa la configuraci√≥</strong>. En fer-ho, apareixer√† l'<strong>enlla√ß per a l'alumnat</strong>, que haur√†s de compartir amb ells perqu√® puguin accedir a la prova.</p>
                <h3>3. Pestanya Respostes: introduir la clau i corregir</h3>
                <p>Aquesta pestanya t√© tres apartats. No cal omplir-los abans que els alumnes facin l'examen, pots completar-los just abans de generar l'informe de correcci√≥.</p>
                <ul>
                    <li><strong>Clau de respostes</strong>: introdueix la seq√º√®ncia de respostes correctes (ex. "BCAD...").</li>
                    <li><strong>Criteris de qualificaci√≥</strong>: defineix la nota m√†xima (ex. 10) i la nota m√≠nima per aprovar (ex. 5).</li>
                    <li><strong>Penalitzaci√≥ per atzar</strong>: si vols que les respostes incorrectes restin, activa la casella i defineix el valor de la penalitzaci√≥. Aquesta mesura busca desincentivar que es respongui a l'atzar. El valor de penalitzaci√≥ recomanat, que anul¬∑la el guany esperat per respondre a l'atzar, es calcula amb la f√≥rmula seg√ºent, on 'm' √©s el nombre d'opcions de resposta:
                        $$ \frac{1}{m-1} $$
                        Per exemple, en un examen amb 4 opcions de resposta (A, B, C, D), el valor a introduir al camp de penalitzaci√≥ seria:
                        $$ \frac{1}{4-1} = \frac{1}{3} \approx 0,33 $$
                    </li>
                </ul>
                <p>Un cop els alumnes hagin respost, prem el bot√≥ <strong>Genera informe de correcci√≥</strong> per obtenir els resultats. Es crear√† un nou Full de C√†lcul al teu Drive amb l'informe detallat.</p>
                <h3>4. Pestanya Ajustos: gesti√≥ de l'aplicaci√≥</h3>
                <p>Aquesta darrera pestanya cont√© opcions per administrar l'aplicaci√≥ i les seves dades. √âs recomanable fer servir aquestes funcions amb precauci√≥.</p>
                <ul>
                    <li><strong>Canvia el codi d'administraci√≥</strong>: et permet establir un nou codi d'acc√©s al panell del professorat per mantenir la seguretat.</li>
                    <li><strong>Esborra lliuraments</strong>: aquesta opci√≥ elimina totes les respostes dels alumnes per a l'examen que tinguis seleccionat. √âs √∫til si vols reutilitzar la mateixa configuraci√≥ d'examen amb un grup diferent.</li>
                    <li><strong>Esborra-ho tot</strong>: aquesta √©s l'opci√≥ m√©s dr√†stica. Elimina tots els ex√†mens, configuracions i respostes que hagis creat, tornant el Full de C√†lcul al seu estat inicial. Fes-la servir nom√©s si vols comen√ßar completament de zero.</li>
                </ul>
            </div>
        </details>

        <details class="accordion">
            <summary><h2>Preguntes i respostes freq√ºents</h2></summary>
            <div class="accordion-content">
                <h3>Puc esborrar un examen concret?</h3>
                <p>S√≠. Per fer-ho, selecciona'l a la pestanya <strong>Resum</strong> i prem el bot√≥ <strong>Esborra aquest examen</strong>. Aquesta acci√≥ elimina completament totes les seves dades: la configuraci√≥, la clau de respostes i tots els lliuraments dels alumnes. Fes-ho servir quan un examen ha finalitzat i ja no el necessites a la llista.</p>
                <h3>Puc esborrar nom√©s les respostes dels alumnes sin esborrar l'examen?</h3>
                <p>S√≠. Ves a la pestanya <strong>Ajustos</strong> i fes servir el bot√≥ <strong>Esborra lliuraments</strong>. Aquesta opci√≥ nom√©s elimina les respostes dels alumnes per a l'examen que tinguis seleccionat. La configuraci√≥ de l'examen (nom, nombre de preguntes, clau, etc.) se mant√© intacta, per la qual cosa √©s l'opci√≥ ideal per reutilitzar el mateix examen amb un grup d'alumnes diferent.</p>
                <h3>Com puc comen√ßar de zero i esborrar totes les meves dades?</h3>
                <p>Si vols restablir l'aplicaci√≥ completament, pots fer servir el bot√≥ <strong>Esborra-ho tot</strong>, que es troba a la pestanya <strong>Ajustos</strong>. Aquesta acci√≥ eliminar√† <em>tots</em> els ex√†mens, configuracions i dades d'alumnes que hagis creat, tornant el Full de C√†lcul al seu estat original.</p>
                <h3>Com puc gestionar ex√†mens de diferents assignatures o cursos de forma totalment separada?</h3>
                <p>Cada c√≤pia del Full de C√†lcul, juntament amb la seva implementaci√≥ web, funciona com un sistema independent. Si vols tenir els ex√†mens de diferents mat√®ries (per exemple, Biologia i Matem√†tiques) o per a diferents cursos (1r de Batxillerat i 2n de Batxillerat) completament separats, nom√©s has de repetir el proc√©s d'instal¬∑laci√≥ inicial:</p>
                <ol>
                    <li><strong>Fes una nova c√≤pia</strong> del Full de C√†lcul base fent servir l'<a href="https://docs.google.com/spreadsheets/d/129xDHV5AcSL8GMu2kmGS2f4Gvs6m0BHn1tkQT-JNfEA/copy" target="_blank" rel="noopener noreferrer">enlla√ß de la plantilla</a>. Posa-li un nom distintiu (ex. "Corrector Biologia").</li>
                    <li>Obre aquest nou full i ves a <strong>Extensions ‚Üí Apps Script</strong>.</li>
                    <li>Torna a seguir els passos per a <strong>Implementa ‚Üí Nova implementaci√≥</strong>.</li>
                </ol>
                <p>Aix√≤ et donar√† una <strong>URL de panell de professorat completament nova i diferent</strong> de l'anterior. D'aquesta manera, tindr√†s un panell per a cada assignatura o curs, cadascun connectat al seu propi Full de C√†lcul, mantenint les dades i ex√†mens totalment a√Øllats.</p>
            </div>
        </details>
        
        <details class="accordion">
            <summary><h2>Dubtes i suggeriments</h2></summary>
            <div class="accordion-content">
                <p>Si trobes algun error, tens algun dubte o vols proposar una millora, pots comunicar-ho a la p√†gina del projecte. Per fer-ho:</p>
                <ol>
                    <li>Ves a <a href="https://github.com/jjdeharo/pcd/issues" target="_blank" rel="noopener noreferrer">https://github.com/jjdeharo/pcd/issues</a>.</li>
                    <li>Prem el bot√≥ verd <strong>New issue</strong>.</li>
                    <li>Escriu la teva consulta o suggeriment.</li>
                </ol>
            </div>
        </details>
        
        <details class="accordion">
            <summary><h2>Llic√®ncies</h2></summary>
            <div class="accordion-content">
                <ul>
                    <li><strong>Codi</strong>: AGPL v3. Consulta <a href="https://github.com/jjdeharo/pcd/blob/main/LICENSE.txt" target="_blank" rel="noopener noreferrer">LICENSE.txt</a>.</li>
                    <li><strong>Continguts</strong>: CC BY-SA 4.0.</li>
                </ul>
            </div>
        </details>
      </section>

      <section class="lang" id="lang-es">
        <details class="accordion" open>
            <summary><h2>¬øQu√© es?</h2></summary>
            <div class="accordion-content">
                <p>Esta plantilla permite recoger las respuestas de <strong>ex√°menes tipo test de elecci√≥n m√∫ltiple (con varias opciones y una √∫nica respuesta correcta)</strong> desde una p√°gina web y guardarlas autom√°ticamente en tu Hoja de C√°lculo de Google.</p>
                <ul>
                    <li>Enlace para el alumnado (web app).</li>
                    <li>Panel del profesorado para configurar, cargar la clave y corregir.</li>
                    <li>Informes detallados con las notas del alumnado y an√°lisis estad√≠sticos de las preguntas.</li>
                </ul>
                <p><strong>Importante:</strong> esta aplicaci√≥n es una <strong>plantilla correctora</strong>. El examen se entrega en papel y el alumnado solo introduce sus respuestas en la web.</p>
            </div>
        </details>

        <details class="accordion">
            <summary><h2>Puesta en marcha de la aplicaci√≥n web</h2></summary>
            <div class="accordion-content">
                <p>El proceso de puesta en marcha consta de dos pasos: <strong>crear tu copia</strong> de la hoja de c√°lculo y <strong>publicar</strong> la aplicaci√≥n web para gestionar los ex√°menes. No tendr√°s que tocar la hoja: el sistema lo har√° por ti.</p>
                <ol>
                    <li>Haz clic en <a href="https://docs.google.com/spreadsheets/d/129xDHV5AcSL8GMu2kmGS2f4Gvs6m0BHn1tkQT-JNfEA/copy" target="_blank" rel="noopener noreferrer">este enlace</a> y pulsa el bot√≥n <strong>Hacer una copia</strong>.</li>
                    <li><strong>Publicaci√≥n</strong> de la aplicaci√≥n web:
                        <ol>
                            <li>En tu nueva hoja de c√°lculo, ve a <em>Extensiones ‚Üí Apps Script</em>.</li>
                            <li>En la ventana que se abre, pulsa <strong>Implementar ‚Üí Nueva implementaci√≥n</strong>.</li>
                            <li>Pulsa <strong>Implementar</strong>.</li>
                            <li>Acepta los permisos:
                                <ul>
                                    <li>Selecciona tu cuenta de Google.</li>
                                    <li>Aparecer√° un aviso indicando que ‚ÄúEsta app no est√° verificada‚Äù. Haz clic en <strong>Avanzado</strong> y luego en <strong>Ir a <em>nombre del proyecto</em> (no seguro)</strong>.</li>
                                    <li>Pulsa <strong>Permitir</strong> en todas las solicitudes de acceso.</li>
                                </ul>
                            </li>
                            <li>Al finalizar, aparecer√° la <strong>URL</strong> de la aplicaci√≥n web. C√≥piala y gu√°rdala: <strong>esa ser√° la direcci√≥n que usar√°s a partir de ahora para acceder al panel del profesorado.</strong></li>
                        </ol>
                    </li>
                    <li><strong>MUY IMPORTANTE:</strong> Accede al panel con el c√≥digo inicial <code>0000</code> y c√°mbialo en la pesta√±a <em>Ajustes</em>.</li>
                </ol>
                <p>Dispones de una presentaci√≥n con im√°genes de todos los pasos. Cons√∫ltala en <a href="https://docs.google.com/presentation/d/e/2PACX-1vRRIav1DWcFyrCVMnE5O60_LUgPbxuAopVCw96caWni9VPDEqRhaasc_Nj5GpiBf9BG3nCM8pml37E1/pub?start=false&loop=false&delayms=3000" target="_blank" rel="noopener noreferrer">este enlace</a>.</p>
            </div>
        </details>
        
        <details class="accordion">
            <summary><h2>Crear y configurar un examen</h2></summary>
            <div class="accordion-content">
                <p>Una vez dentro del panel de administraci√≥n, el proceso para crear un examen se realiza a trav√©s de las diferentes pesta√±as.</p>
                <h3>1. Pesta√±a Resumen: crear el examen</h3>
                <p>En la primera pesta√±a, <strong>Resumen</strong>, pulsa el bot√≥n <strong>Crea examen nuevo</strong>. La aplicaci√≥n generar√° un identificador √∫nico para el examen; a continuaci√≥n, deber√°s ir a la pesta√±a <strong>Configuraci√≥n</strong> para definir sus par√°metros. Si ya tienes ex√°menes creados, puedes seleccionarlos desde el men√∫ desplegable.</p>
                <h3>2. Pesta√±a Configuraci√≥n: definir los par√°metros</h3>
                <p>Aqu√≠ se establecen las caracter√≠sticas principales de la prueba:</p>
                <ul>
                    <li><strong>Nombre del examen</strong>: un t√≠tulo para identificarlo (ej. "Examen Biolog√≠a Tema 5").</li>
                    <li><strong>N√∫mero de preguntas</strong>: el total de preguntas que tiene la prueba.</li>
                    <li><strong>Opciones disponibles</strong>: las letras de las respuestas (ej. ABCD, ABCDE).</li>
                    <li><strong>Inicio y fin programado</strong>: puedes definir una fecha y hora para que el examen se abra y se cierre autom√°ticamente. Si lo dejas en blanco, tendr√°s que abrirlo y cerrarlo manualmente. Aunque establezcas una fecha, siempre puedes forzar la apertura o el cierre desde los controles manuales.</li>
                    <li><strong>Medidas de seguridad</strong>: puedes activar opciones como barajar preguntas y/o respuestas, o forzar la pantalla completa (aunque el alumno puede salir de este modo, la ventana se volver√° a maximizar con cada clic que haga en la prueba).</li>
                </ul>
                <p>Cuando hayas rellenado todo, pulsa <strong>Guardar la configuraci√≥n</strong>. Al hacerlo, aparecer√° el <strong>enlace para el alumnado</strong>, que deber√°s compartir con ellos para que puedan acceder a la prueba.</p>
                <h3>3. Pesta√±a Respuestas: introducir la clave y corregir</h3>
                <p>Esta pesta√±a tiene tres apartados. No es necesario rellenarlos antes de que los alumnos hagan el examen, puedes completarlos justo antes de generar el informe de correcci√≥n.</p>
                <ul>
                    <li><strong>Clave de respuestas</strong>: introduce la secuencia de respuestas correctas (ej. "BCAD...").</li>
                    <li><strong>Criterios de calificaci√≥n</strong>: define la nota m√°xima (ej. 10) y la nota m√≠nima para aprobar (ej. 5).</li>
                    <li><strong>Penalizaci√≥n por azar</strong>: si quieres que las respuestas incorrectas resten, activa la casilla y define el valor de la penalizaci√≥n. Esta medida busca desincentivar que se responda al azar. El valor de penalizaci√≥n recomendado, que anula la ganancia esperada por responder al azar, se calcula con la siguiente f√≥rmula, donde 'm' es el n√∫mero de opciones de respuesta:
                        $$ \frac{1}{m-1} $$
                        Por ejemplo, en un examen con 4 opciones de respuesta (A, B, C, D), el valor a introducir en el campo de penalizaci√≥n ser√≠a:
                        $$ \frac{1}{4-1} = \frac{1}{3} \approx 0,33 $$
                    </li>
                </ul>
                <p>Una vez que los alumnos hayan respondido, pulsa el bot√≥n <strong>Generar informe de correcci√≥n</strong> para obtener los resultados. Se crear√° una nueva Hoja de C√°lculo en tu Drive con el informe detallado.</p>
                <h3>4. Pesta√±a Ajustes: gesti√≥n de la aplicaci√≥n</h3>
                <p>Esta √∫ltima pesta√±a contiene opciones para administrar la aplicaci√≥n y sus datos. Es recomendable usar estas funciones con precauci√≥n.</p>
                <ul>
                    <li><strong>Cambiar el c√≥digo de administraci√≥n</strong>: te permite establecer un nuevo c√≥digo de acceso al panel del profesorado para mantener la seguridad.</li>
                    <li><strong>Borrar env√≠os</strong>: esta opci√≥n elimina todas las respuestas de los alumnos para el examen que tengas seleccionado. Es √∫til si quieres reutilizar la misma configuraci√≥n de examen con un grupo diferente.</li>
                    <li><strong>Borrar todo</strong>: esta es la opci√≥n m√°s dr√°stica. Elimina todos los ex√°menes, configuraciones y respuestas que hayas creado, devolviendo la Hoja de C√°lculo a su estado inicial. √ösala solo si quieres empezar completamente de cero.</li>
                </ul>
            </div>
        </details>

        <details class="accordion">
            <summary><h2>Preguntas y respuestas frecuentes</h2></summary>
            <div class="accordion-content">
                <h3>¬øPuedo borrar un examen concreto?</h3>
                <p>S√≠. Para ello, selecci√≥nalo en la pesta√±a <strong>Resumen</strong> y pulsa el bot√≥n <strong>Borrar este examen</strong>. Esta acci√≥n elimina por completo todos sus datos: la configuraci√≥n, la clave de respuestas y todos los env√≠os de los alumnos. √ösalo cuando un examen ha finalizado y ya no lo necesitas en la lista.</p>
                <h3>¬øPuedo borrar solo las respuestas de los alumnos sin borrar el examen?</h3>
                <p>S√≠. Ve a la pesta√±a <strong>Ajustes</strong> y usa el bot√≥n <strong>Borrar env√≠os</strong>. Esta opci√≥n solo elimina las respuestas de los alumnos para el examen que tengas seleccionado. La configuraci√≥n del examen (nombre, n√∫mero de preguntas, clave, etc.) se mantiene intacta, por lo que es la opci√≥n ideal para reutilizar el mismo examen con un grupo de alumnos diferente.</p>
                <h3>¬øC√≥mo puedo empezar de cero y borrar todos mis datos?</h3>
                <p>Si quieres restablecer la aplicaci√≥n por completo, puedes usar el bot√≥n <strong>Borrar todo</strong>, que se encuentra en la pesta√±a <strong>Ajustes</strong>. Esta acci√≥n eliminar√° <em>todos</em> los ex√°menes, configuraciones y datos de alumnos que hayas creado, devolviendo la Hoja de C√°lculo a su estado original.</p>
                <h3>¬øC√≥mo puedo gestionar ex√°menes de diferentes asignaturas o cursos de forma totalmente separada?</h3>
                <p>Cada copia de la Hoja de C√°lculo, junto con su implementaci√≥n web, funciona como un sistema independiente. Si quieres tener los ex√°menes de diferentes materias (por ejemplo, Biolog√≠a y Matem√°ticas) o para distintos cursos (1¬∫ de Bachillerato y 2¬∫ de Bachillerato) completamente separados, solo tienes que repetir el proceso de instalaci√≥n inicial:</p>
                <ol>
                    <li><strong>Haz una nueva copia</strong> de la Hoja de C√°lculo base usando el <a href="https://docs.google.com/spreadsheets/d/129xDHV5AcSL8GMu2kmGS2f4Gvs6m0BHn1tkQT-JNfEA/copy" target="_blank" rel="noopener noreferrer">enlace de la plantilla</a>. Dale un nombre distintivo (ej. "Corrector Biolog√≠a").</li>
                    <li>Abre esa nueva hoja y ve a <strong>Extensiones ‚Üí Apps Script</strong>.</li>
                    <li>Vuelve a seguir los pasos para <strong>Implementar ‚Üí Nueva implementaci√≥n</strong>.</li>
                </ol>
                <p>Esto te dar√° una <strong>URL de panel de profesorado completamente nueva y distinta</strong> a la anterior. De esta forma, tendr√°s un panel para cada asignatura o curso, cada uno conectado a su propia Hoja de C√°lculo, manteniendo los datos y ex√°menes totalmente aislados.</p>
            </div>
        </details>
        
        <details class="accordion">
            <summary><h2>Dudas y sugerencias</h2></summary>
            <div class="accordion-content">
                <p>Si encuentras alg√∫n error, tienes alguna duda o quieres proponer una mejora, puedes comunicarlo en la p√°gina del proyecto. Para ello:</p>
                <ol>
                    <li>Ve a <a href="https://github.com/jjdeharo/pcd/issues" target="_blank" rel="noopener noreferrer">https://github.com/jjdeharo/pcd/issues</a>.</li>
                    <li>Pulsa el bot√≥n verde <strong>New issue</strong>.</li>
                    <li>Escribe tu consulta o sugerencia.</li>
                </ol>
            </div>
        </details>
        
        <details class="accordion">
            <summary><h2>Licencias</h2></summary>
            <div class="accordion-content">
                <ul>
                    <li><strong>C√≥digo</strong>: AGPL v3. Consulta <a href="https://github.com/jjdeharo/pcd/blob/main/LICENSE.txt" target="_blank" rel="noopener noreferrer">LICENSE.txt</a>.</li>
                    <li><strong>Contenidos</strong>: CC BY-SA 4.0.</li>
                </ul>
            </div>
        </details>
      </section>

      <footer class="app-footer">
        <div id="footer-app" class="app-name">Plantilla correctora digital</div>
        <div id="footer-docs" class="docs-line">&nbsp;</div>
        <div id="footer-line1">&nbsp;</div>
        <div id="footer-line2" class="lic-line">&nbsp;</div>
      </footer>
    </div>

    <script>
      // ===== Idioma =====
      const langButtons = document.querySelectorAll('.switch .btn');
      const sections = {
        ca: document.getElementById('lang-ca'),
        es: document.getElementById('lang-es')
      };
      const I18N_FOOTER = {
        ca: {
          appName: 'Plantilla correctora digital',
          docs: '<a href="https://jjdeharo.github.io/pcd/" target="_blank" rel="noopener">Documentaci√≥</a>',
          line1: '<a href="https://bilateria.es" target="_blank" rel="noopener">¬© Juan Jos√© de Haro</a>',
          line2: 'Llic√®ncia del codi: <a href="https://github.com/jjdeharo/pcd/blob/main/LICENSE.txt" target="_blank" rel="noopener">AGPL v3</a> ¬∑ Contingut: <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener">CC BY-SA 4.0</a> <img class="cc" alt="CC BY-SA 4.0" src="https://licensebuttons.net/l/by-sa/4.0/88x31.png" />'
        },
        es: {
          appName: 'Plantilla correctora digital',
          docs: '<a href="https://jjdeharo.github.io/pcd/" target="_blank" rel="noopener">Documentaci√≥n</a>',
          line1: '<a href="https://bilateria.es" target="_blank" rel="noopener">¬© Juan Jos√© de Haro</a>',
          line2: 'Licencia del c√≥digo: <a href="https://github.com/jjdeharo/pcd/blob/main/LICENSE.txt" target="_blank" rel="noopener">AGPL v3</a> ¬∑ Contenido: <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener">CC BY-SA 4.0</a> <img class="cc" alt="CC BY-SA 4.0" src="https://licensebuttons.net/l/by-sa/4.0/88x31.png" />'
        }
      };
      function renderFooterDocs(currentLang) {
        try {
          const f = I18N_FOOTER[currentLang] || I18N_FOOTER.ca;
          const app = document.getElementById('footer-app');
          const docs = document.getElementById('footer-docs');
          const l1 = document.getElementById('footer-line1');
          const l2 = document.getElementById('footer-line2');
          if (app) app.textContent = f.appName || 'Plantilla correctora digital';
          if (docs) docs.innerHTML = f.docs || '';
          if (l1) l1.innerHTML = f.line1;
          if (l2) l2.innerHTML = f.line2;
        } catch (e) {}
      }
      function setLang(lang) {
        langButtons.forEach(b => b.classList.toggle('active', b.dataset.lang === lang));
        Object.entries(sections).forEach(([k, el]) => el.classList.toggle('active', k === lang));
        document.documentElement.lang = lang;
        renderFooterDocs(lang);
      }
      langButtons.forEach(b => b.addEventListener('click', () => setLang(b.dataset.lang)));
      // Auto: seg√∫n navegador
      const nav = (navigator.language || 'ca').toLowerCase();
      setLang(nav.startsWith('es') ? 'es' : 'ca');

      // ===== Tema (claro/oscuro/auto) =====
      const THEME_KEY = 'pcd:docs:theme';
      const themeButtons = document.querySelectorAll('.theme-btn');
      function applyTheme(mode) {
        if (mode === 'light' || mode === 'dark') {
          document.documentElement.setAttribute('data-theme', mode);
        } else {
          document.documentElement.removeAttribute('data-theme');
        }
        themeButtons.forEach(b => b.classList.toggle('active', b.dataset.theme === mode));
      }
      function setTheme(mode) {
        const m = (mode === 'light' || mode === 'dark') ? mode : 'auto';
        try { localStorage.setItem(THEME_KEY, m); } catch (e) {}
        applyTheme(m);
      }
      themeButtons.forEach(b => b.addEventListener('click', () => setTheme(b.dataset.theme)));
      const savedTheme = (function(){ try { return localStorage.getItem(THEME_KEY) || 'auto'; } catch(e) { return 'auto'; } })();
      applyTheme(savedTheme);

      // ===== Accordion functionality =====
      const accordions = document.querySelectorAll('details.accordion');
      accordions.forEach(currentAccordion => {
        currentAccordion.addEventListener('toggle', (event) => {
          if (currentAccordion.open) {
            
            accordions.forEach(otherAccordion => {
              if (otherAccordion !== currentAccordion) {
                otherAccordion.open = false;
              }
            });

            setTimeout(() => {
              // Only scroll into view if the opened accordion is NOT the first one in its section.
              // This prevents the page from jumping on load.
              const isFirstInSection = currentAccordion.parentElement.querySelector('details.accordion') === currentAccordion;
              if (!isFirstInSection) {
                currentAccordion.querySelector('summary').scrollIntoView({
                  behavior: 'smooth',
                  block: 'start'
                });
              }
            }, 100); // A small delay to ensure other accordions have closed and layout is stable.
          }
        });
      });
    </script>
  </body>
</html>
